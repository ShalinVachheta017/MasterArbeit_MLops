# ============================================================================
# Pipeline Configuration
# ============================================================================
# This file controls the production pipeline behavior.
# Toggle preprocessing steps on/off with true/false values.
#
# RESEARCH PAPER REFERENCE (ICTH_16, Oleh & Obermaisser 2025):
#   Training pipeline was: milliG -> m/s2 -> StandardScaler -> Window(200,50%)
#   NO gravity removal was applied during training.
#   NO filtering was applied during training.
#
# RULE: Production preprocessing MUST match training preprocessing.
#       Mismatch = domain shift = wrong predictions.
# ============================================================================

# --------------------------------------------------------------------------
# PREPROCESSING TOGGLES  (edit these to control what preprocessing runs)
# --------------------------------------------------------------------------
preprocessing:

  # Unit Conversion  (milliG -> m/s2)
  # RECOMMENDED: true
  # WHY: Production data from Garmin is in milliG.
  #      Training data (all_users_data_labeled) is in m/s2.
  #      The StandardScaler expects m/s2 input.
  #      Paper: "Accelerometer data was converted from milli-g to m/s2"
  enable_unit_conversion: true

  # Gravity Removal  (Butterworth high-pass filter)
  # RECOMMENDED: false
  # WHY: Training data has gravity INCLUDED:
  #      - all_users_data_labeled accel magnitude = 9.83 m/s2 (=1g)
  #      - ADAMSense wrist magnitude = 0.995 (approx 1g in g-units)
  #      - Paper says "NO gravity removal mentioned"
  # RISK: Setting true creates domain shift -> hand_tapping dominance
  enable_gravity_removal: false

  # Domain Calibration  (experimental)
  # RECOMMENDED: false
  # WHY: Not part of original training pipeline.
  #      Only enable for domain adaptation experiments.
  enable_calibration: false

  # Gravity removal filter parameters (only used if enable_gravity_removal: true)
  gravity_filter:
    cutoff_hz: 0.3       # Cutoff frequency (0.3 Hz is standard from UCI HAR)
    order: 3              # Filter order (3 is typical)

  # Sampling frequency of the data
  sampling_frequency_hz: 50

  # Resampling settings
  resampling:
    enabled: true
    target_hz: 50
    interpolation_method: linear

# Data Validation Settings
validation:
  enabled: true
  thresholds:
    max_missing_ratio: 0.05        # Max 5% missing values allowed
    max_acceleration_ms2: 50.0     # Max reasonable acceleration (m/s2)
    max_gyroscope_dps: 500.0       # Max reasonable gyroscope (deg/s)
    sampling_rate_tolerance: 0.1   # 10% tolerance for sampling rate check

# Logging Settings
logging:
  level: INFO
  log_to_file: true
  log_dir: logs/preprocessing
  max_bytes: 2000000
  backup_count: 3

# Output Settings
output:
  save_intermediate: false
  suffix_gravity_removed: "_gravity_removed"

# Model Inference Settings
inference:
  window_size: 200       # samples (4 seconds at 50 Hz)
  window_overlap: 0.5    # 50% overlap
  batch_size: 32
